# ê°¤ëŸ­ì‹œ ì›Œì¹˜ ì‹¬ë°•ìˆ˜ ë°ì´í„° ì‹œë®¬ë ˆì´í„°

VR ë©´ì ‘ ì¤‘ ê°¤ëŸ­ì‹œ ì›Œì¹˜ì—ì„œ ì¸¡ì •í•œ ì‹¬ë°•ìˆ˜ ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì „ì†¡í•˜ëŠ” ê²ƒì„ ì‹œë®¬ë ˆì´ì…˜í•˜ëŠ” ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ëª¨ìŒì…ë‹ˆë‹¤.

## ğŸ“ íŒŒì¼ êµ¬ì„±

```
heartbeat-simulator/
â”œâ”€â”€ README.md                          # ì´ íŒŒì¼
â”œâ”€â”€ send_heartbeat_batch.sh            # ê¸°ë³¸ ë°°ì¹˜ ì „ì†¡ (Bash)
â”œâ”€â”€ send_heartbeat_batch.ps1           # ê¸°ë³¸ ë°°ì¹˜ ì „ì†¡ (PowerShell - Windowsìš©)
â”œâ”€â”€ generate_realistic_heartbeat.sh    # í˜„ì‹¤ì ì¸ íŒ¨í„´ ì‹œë®¬ë ˆì´í„°
â””â”€â”€ test_heartbeat_api.sh              # ê°„ë‹¨í•œ API í…ŒìŠ¤íŠ¸
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### Linux / macOS / Git Bash (Windows)

#### 1. ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬

```bash
cd scripts/heartbeat-simulator
chmod +x *.sh
```
### 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
# JWT í† í° ì„¤ì • (í•„ìˆ˜)
export JWT_TOKEN="your-actual-jwt-token-here"

# API URL ì„¤ì • (ì„ íƒì‚¬í•­, ê¸°ë³¸ê°’: http://localhost:8080)
export API_URL="http://localhost:8080"
```

#### 3. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

```bash
# ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ (50ê°œ ë°ì´í„°, 1ë¶„ì¹˜)
./test_heartbeat_api.sh

# ê¸°ë³¸ ì‹¤í–‰ (900ê°œ ë°ì´í„°, 15ë¶„ì¹˜)
./send_heartbeat_batch.sh

# í˜„ì‹¤ì ì¸ íŒ¨í„´ìœ¼ë¡œ ì‹¤í–‰ (1080ê°œ ë°ì´í„°, 18ë¶„ì¹˜)
./generate_realistic_heartbeat.sh
```

---

### Windows PowerShell

#### 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```powershell
# JWT í† í° ì„¤ì • (í•„ìˆ˜)
$env:JWT_TOKEN = "your-actual-jwt-token-here"

# API URL ì„¤ì • (ì„ íƒì‚¬í•­)
$env:API_URL = "http://localhost:8080"
```

#### 2. ì‹¤í–‰ ì •ì±… ì„¤ì • (ì²˜ìŒ í•œ ë²ˆë§Œ)

```powershell
# í˜„ì¬ ì‚¬ìš©ìì— ëŒ€í•´ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ í—ˆìš©
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

#### 3. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

```powershell
cd scripts\heartbeat-simulator

# ê¸°ë³¸ ì‹¤í–‰ (ë©´ì ‘ ID: 1, 15ë¶„)
.\send_heartbeat_batch.ps1

# ë©´ì ‘ ID ì§€ì •
.\send_heartbeat_batch.ps1 -InterviewId 5

# ëª¨ë“  ë§¤ê°œë³€ìˆ˜ ì§€ì •
.\send_heartbeat_batch.ps1 -InterviewId 5 -DeviceUuid "my-watch-uuid" -DurationMinutes 20
```

---

## ğŸ“‹ ìŠ¤í¬ë¦½íŠ¸ ìƒì„¸ ì„¤ëª…

### 1ï¸âƒ£ send_heartbeat_batch.sh

**ê¸°ëŠ¥**: ë©´ì ‘ ì‹œê°„ì— ë”°ë¥¸ ì‹¬ë°•ìˆ˜ ë°ì´í„°ë¥¼ ë°°ì¹˜ë¡œ ìƒì„±í•˜ê³  ì„œë²„ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.

**ì‹¬ë°•ìˆ˜ íŒ¨í„´**:
- ì‹œì‘ (0-10%): 70-90 BPM (ê¸´ì¥)
- ì¤‘ë°˜ (10-70%): 65-75 BPM (ì•ˆì •)
- í›„ë°˜ (70-100%): 75-95 BPM (ë‹¤ì‹œ ê¸´ì¥)

**ì‚¬ìš©ë²•**:
```bash
./send_heartbeat_batch.sh [ë©´ì ‘ID] [ë””ë°”ì´ìŠ¤UUID] [ë©´ì ‘ì‹œê°„(ë¶„)]
```

**ì˜ˆì‹œ**:
```bash
# ê¸°ë³¸ ì‹¤í–‰ (ë©´ì ‘ ID: 1, ê¸°ë³¸ UUID, 15ë¶„)
./send_heartbeat_batch.sh

# ë©´ì ‘ ID 5ë²ˆìœ¼ë¡œ ì‹¤í–‰
./send_heartbeat_batch.sh 5

# ë©´ì ‘ ID 5ë²ˆ, ì»¤ìŠ¤í…€ UUIDë¡œ ì‹¤í–‰
./send_heartbeat_batch.sh 5 "my-galaxy-watch-uuid-123"

# ë©´ì ‘ ID 5ë²ˆ, ì»¤ìŠ¤í…€ UUID, 20ë¶„ ë°ì´í„°ë¡œ ì‹¤í–‰
./send_heartbeat_batch.sh 5 "my-galaxy-watch-uuid-123" 20
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
==================================================
    ê°¤ëŸ­ì‹œ ì›Œì¹˜ ì‹¬ë°•ìˆ˜ ë°ì´í„° ì „ì†¡ ì‹œë®¬ë ˆì´í„°
==================================================
ë©´ì ‘ ID: 1
ë””ë°”ì´ìŠ¤ UUID: 550e8400-e29b-41d4-a716-446655440000
ë©´ì ‘ ì‹œê°„: 15ë¶„
==================================================

ì´ 900ê°œì˜ ì‹¬ë°•ìˆ˜ ë°ì´í„° ìƒì„± ì¤‘...

ìƒì„± ì§„í–‰ë¥ : 0%
ìƒì„± ì§„í–‰ë¥ : 10%
...
ìƒì„± ì§„í–‰ë¥ : 100%

ë°ì´í„° ìƒì„± ì™„ë£Œ!
ì„œë²„ë¡œ ì „ì†¡ ì¤‘...

==================================================
âœ“ ì „ì†¡ ì„±ê³µ! (HTTP 200)
{"success": true, "data": null}
==================================================
```

---

### 2ï¸âƒ£ generate_realistic_heartbeat.sh

**ê¸°ëŠ¥**: ì‹¤ì œ ë©´ì ‘ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë°˜ì˜í•œ í˜„ì‹¤ì ì¸ ì‹¬ë°•ìˆ˜ íŒ¨í„´ì„ ìƒì„±í•©ë‹ˆë‹¤.

**ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ íŒ¨í„´**:
| ì‹œê°„ | ì‹œë‚˜ë¦¬ì˜¤ | BPM ë²”ìœ„ | ì„¤ëª… |
|------|----------|----------|------|
| 0-2ë¶„ | ëŒ€ê¸° ë° ì¸ì‚¬ | 70-90 | ë©´ì ‘ ì‹œì‘ ê¸´ì¥ |
| 2-5ë¶„ | ìê¸°ì†Œê°œ | 65-75 | ì•ˆì •í™” ì‹œì‘ |
| 5-10ë¶„ | ê¸°ìˆ  ì§ˆë¬¸ | 70-85 | ì§‘ì¤‘ ìƒíƒœ |
| 10-15ë¶„ | ì••ë°• ì§ˆë¬¸ | 80-100 | ê¸´ì¥ë„ ìµœê³ ì¡° |
| 15-18ë¶„ | ë§ˆë¬´ë¦¬ | 70-80 | ì•ˆì • ë³µê·€ |

**ì‚¬ìš©ë²•**:
```bash
./generate_realistic_heartbeat.sh [ë©´ì ‘ID] [ë””ë°”ì´ìŠ¤UUID]
```

**ì˜ˆì‹œ**:
```bash
# ê¸°ë³¸ ì‹¤í–‰ (ë©´ì ‘ ID: 1, ê¸°ë³¸ UUID)
./generate_realistic_heartbeat.sh

# ë©´ì ‘ ID 3ë²ˆìœ¼ë¡œ ì‹¤í–‰
./generate_realistic_heartbeat.sh 3

# ë©´ì ‘ ID 3ë²ˆ, ì»¤ìŠ¤í…€ UUIDë¡œ ì‹¤í–‰
./generate_realistic_heartbeat.sh 3 "watch-uuid-789"
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
==================================================
  í˜„ì‹¤ì ì¸ ë©´ì ‘ ì‹¬ë°•ìˆ˜ íŒ¨í„´ ì‹œë®¬ë ˆì´í„°
==================================================
ì‹œë‚˜ë¦¬ì˜¤: ëŒ€ê¸°_ë°_ì¸ì‚¬ (70Â±20 BPM)
ì‹œë‚˜ë¦¬ì˜¤: ìê¸°ì†Œê°œ (65Â±10 BPM)
ì‹œë‚˜ë¦¬ì˜¤: ê¸°ìˆ ì§ˆë¬¸ (75Â±15 BPM)
ì‹œë‚˜ë¦¬ì˜¤: ì••ë°•ì§ˆë¬¸ (85Â±15 BPM)
ì‹œë‚˜ë¦¬ì˜¤: ë§ˆë¬´ë¦¬ (70Â±10 BPM)

ë°ì´í„° ìƒì„± ì™„ë£Œ! ì„œë²„ë¡œ ì „ì†¡ ì¤‘...

==================================================
âœ“ ì „ì†¡ ì„±ê³µ! (HTTP 200)
{"success": true, "data": null}
==================================================
```

---

### 3ï¸âƒ£ test_heartbeat_api.sh

**ê¸°ëŠ¥**: API ì—°ê²°ì„ ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ ê°„ë‹¨í•œ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.

**íŠ¹ì§•**:
- 50ê°œì˜ ë°ì´í„° í¬ì¸íŠ¸ë§Œ ìƒì„± (1ë¶„ì¹˜)
- ë¹ ë¥¸ ì‹¤í–‰ (ìˆ˜ ì´ˆ ì´ë‚´)
- 70-90 BPM ëœë¤ ë°ì´í„°

**ì‚¬ìš©ë²•**:
```bash
./test_heartbeat_api.sh [ë©´ì ‘ID]
```

**ì˜ˆì‹œ**:
```bash
# ê¸°ë³¸ ì‹¤í–‰ (ë©´ì ‘ ID: 1)
./test_heartbeat_api.sh

# ë©´ì ‘ ID 2ë²ˆìœ¼ë¡œ í…ŒìŠ¤íŠ¸
./test_heartbeat_api.sh 2
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
======================================
  ì‹¬ë°•ìˆ˜ API í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
======================================
ë©´ì ‘ ID: 1
ë°ì´í„° ê°œìˆ˜: 50ê°œ (1ë¶„ì¹˜)
======================================

ì„œë²„ë¡œ ì „ì†¡ ì¤‘...

âœ“ í…ŒìŠ¤íŠ¸ ì„±ê³µ! (HTTP 200)
{"success": true, "data": null}

======================================
í…ŒìŠ¤íŠ¸ ì™„ë£Œ!
======================================
```

---

## âš™ï¸ í™˜ê²½ ë³€ìˆ˜

### JWT_TOKEN (í•„ìˆ˜)
- **ì„¤ëª…**: ì„œë²„ ì¸ì¦ì„ ìœ„í•œ JWT í† í°
- **íšë“ ë°©ë²•**: ë¡œê·¸ì¸ API í˜¸ì¶œ í›„ ë°›ì€ Access Token
- **ì„¤ì • ë°©ë²•**:
  ```bash
  export JWT_TOKEN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  ```

### API_URL (ì„ íƒ)
- **ì„¤ëª…**: ë°±ì—”ë“œ ì„œë²„ ì£¼ì†Œ
- **ê¸°ë³¸ê°’**: `http://localhost:8080`
- **ì„¤ì • ë°©ë²•**:
  ```bash
  # ë¡œì»¬ ì„œë²„
  export API_URL="http://localhost:8080"
  
  # ê°œë°œ ì„œë²„
  export API_URL="https://dev-api.example.com"
  ```

---

## ğŸ” ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ê°œë°œ ì¤‘ API í…ŒìŠ¤íŠ¸
```bash
# 1. ë¹ ë¥¸ ì—°ê²° í…ŒìŠ¤íŠ¸
./test_heartbeat_api.sh 1

# 2. ë¬¸ì œ ì—†ìœ¼ë©´ ì „ì²´ í…ŒìŠ¤íŠ¸
./send_heartbeat_batch.sh 1
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ë‹¤ì–‘í•œ ë©´ì ‘ ë°ì´í„° ìƒì„±
```bash
# ë©´ì ‘ 1ë²ˆ: 15ë¶„ ì¼ë°˜ íŒ¨í„´
./send_heartbeat_batch.sh 1 "watch-001" 15

# ë©´ì ‘ 2ë²ˆ: 20ë¶„ ì¼ë°˜ íŒ¨í„´
./send_heartbeat_batch.sh 2 "watch-001" 20

# ë©´ì ‘ 3ë²ˆ: 18ë¶„ í˜„ì‹¤ì  íŒ¨í„´
./generate_realistic_heartbeat.sh 3 "watch-001"
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
```bash
# ê¸´ ì‹œê°„ì˜ ë°ì´í„°ë¡œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (30ë¶„)
./send_heartbeat_batch.sh 10 "watch-perf-test" 30
```

---

## ğŸ› ï¸ ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: Permission denied
```bash
# í•´ê²°: ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x *.sh
```

### ë¬¸ì œ 2: JWT_TOKEN not found
```bash
# í•´ê²°: í™˜ê²½ ë³€ìˆ˜ ì„¤ì • í™•ì¸
echo $JWT_TOKEN

# ì„¤ì •ë˜ì§€ ì•Šì•˜ë‹¤ë©´
export JWT_TOKEN="your-token-here"
```

### ë¬¸ì œ 3: Connection refused
```bash
# í•´ê²° 1: ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
curl http://localhost:8080/actuator/health

# í•´ê²° 2: API_URLì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸
echo $API_URL
```

### ë¬¸ì œ 4: 403 Forbidden
```bash
# í•´ê²°: JWT í† í°ì´ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ì˜ëª»ë¨
# 1. ë¡œê·¸ì¸ APIë¡œ ìƒˆ í† í° ë°œê¸‰
# 2. JWT_TOKEN í™˜ê²½ ë³€ìˆ˜ ì¬ì„¤ì •
```

### ë¬¸ì œ 5: 404 Not Found (ë©´ì ‘ ì—†ìŒ)
```bash
# í•´ê²°: Interview ë°ì´í„°ë¥¼ ë¨¼ì € ìƒì„±
# 1. ìì†Œì„œ ë“±ë¡
# 2. ë©´ì ‘ ìƒì„±
# 3. ìƒì„±ëœ ë©´ì ‘ IDë¡œ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
```

---

## ğŸ“Š ë°ì´í„° í™•ì¸

### MongoDBì—ì„œ í™•ì¸
```bash
# MongoDB Shell ì ‘ì†
docker exec -it mongodb mongosh

# ì¸ì¦
use admin
db.auth('admin', 'admin123')

# mindstage DBë¡œ ì „í™˜
use mindstage

# heartbeats ì»¬ë ‰ì…˜ í™•ì¸
db.heartbeats.find({interviewId: 1}).limit(5).pretty()

# í†µê³„ í™•ì¸
db.heartbeats.aggregate([
  { $match: { interviewId: 1 } },
  { $group: {
    _id: "$interviewId",
    count: { $sum: 1 },
    avgBpm: { $avg: "$bpm" },
    minBpm: { $min: "$bpm" },
    maxBpm: { $max: "$bpm" }
  }}
])
```

### REST APIë¡œ ì¡°íšŒ
```bash
# ë©´ì ‘ 1ë²ˆì˜ ì‹¬ë°•ìˆ˜ ë°ì´í„° ì¡°íšŒ
curl -X GET "http://localhost:8080/api/heartbeat/interview/1" \
  -H "Authorization: Bearer ${JWT_TOKEN}" | jq .
```

---

## ğŸ’¡ íŒ

1. **í™˜ê²½ ë³€ìˆ˜ë¥¼ íŒŒì¼ë¡œ ê´€ë¦¬**
   ```bash
   # .env íŒŒì¼ ìƒì„±
   echo 'export JWT_TOKEN="your-token"' > .env
   echo 'export API_URL="http://localhost:8080"' >> .env
   
   # ì‚¬ìš© ì‹œ
   source .env
   ./send_heartbeat_batch.sh
   ```

2. **ì—¬ëŸ¬ ë©´ì ‘ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ìƒì„±**
   ```bash
   #!/bin/bash
   for i in {1..5}; do
     ./send_heartbeat_batch.sh $i "watch-$i" 15
     sleep 2
   done
   ```

3. **ë¡œê·¸ íŒŒì¼ë¡œ ì €ì¥**
   ```bash
   ./send_heartbeat_batch.sh 1 | tee heartbeat_log.txt
   ```

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- **API ë¬¸ì„œ**: http://localhost:8080/swagger-ui.html
- **MongoDB ê°€ì´ë“œ**: ../docs/mongodb-setup.md
- **ë°±ì—”ë“œ README**: ../../README.md

---

## ğŸ“ ì°¸ê³ ì‚¬í•­

- **ë°ì´í„° í¬ê¸°**: 15ë¶„ ë©´ì ‘ = ì•½ 900ê°œ ë°ì´í„° í¬ì¸íŠ¸ (1ì´ˆë‹¹ 1ê°œ)
- **ì „ì†¡ ì‹œê°„**: 900ê°œ ë°ì´í„° ì „ì†¡ì— ì•½ 2-5ì´ˆ ì†Œìš”
- **ë„¤íŠ¸ì›Œí¬**: ë°°ì¹˜ ì „ì†¡ìœ¼ë¡œ íš¨ìœ¨ì  (ê°œë³„ ì „ì†¡ ëŒ€ë¹„ 900ë°° ë¹ ë¦„)
- **í¬ë¡œìŠ¤ í”Œë«í¼**: Linux, macOS, Windows (Git Bash) ì§€ì›

---

**ì‘ì„±ì¼**: 2025-11-05
**ë²„ì „**: 1.0.0

